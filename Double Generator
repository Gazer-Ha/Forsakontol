local map = workspace:WaitForChild("Map"):WaitForChild("Ingame"):WaitForChild("Map")
local generators = {}

local function hookGenerator(generator)
    if generators[generator] then return end

    local remotes = generator:FindFirstChild("Remotes")
    if remotes then
        local RF = remotes:FindFirstChild("RF")
        local RE = remotes:FindFirstChild("RE")

        if RF and RF:IsA("RemoteFunction") and RE and RE:IsA("RemoteEvent") then
            RE.OnClientEvent:Connect(function(...)
                RF:FireServer(...)
            end)

            generators[generator] = true
        end
    end
end

local function updateGenerators()
    for generator in pairs(generators) do
        if not generator or not generator.Parent then
            generators[generator] = nil
        end
    end
end

for _, generator in ipairs(map:GetDescendants()) do
    if generator:IsA("Model") and generator.Name == "Generator" then
        hookGenerator(generator)
    end
end

map.DescendantAdded:Connect(function(obj)
    if obj:IsA("Model") and obj.Name == "Generator" then
        hookGenerator(obj)
    end
end)

while true do
    updateGenerators()
    task.wait(5)
end
