local player = game.Players.LocalPlayer
local runService = cloneref(game:GetService("RunService"))

local function setupRotation(character)
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    local humanoid = character:WaitForChild("Humanoid")

    runService.RenderStepped:Connect(function()
        if character.Parent then -- Ensure character still exists
            local moveDirection = humanoid.MoveDirection
            if moveDirection.Magnitude > 0 then
                humanoidRootPart.CFrame = CFrame.new(humanoidRootPart.Position) * CFrame.lookAt(Vector3.new(), moveDirection)
            end
        end
    end)
end

local function onCharacterAdded(character)
    setupRotation(character)
end

-- Setup rotation for the current character
if player.Character then
    setupRotation(player.Character)
end

-- Listen for new character spawns
player.CharacterAdded:Connect(onCharacterAdded)
