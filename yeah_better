local plr = game.Players.LocalPlayer
local rs = game:GetService("RunService")

local rotSpd = 0.025
local tpChance = 1
local minN = 0.01
local maxN = 0.08

local function applyFX(char)
    local hum = char:WaitForChild("Humanoid")
    local root = char:WaitForChild("HumanoidRootPart")

    rs.RenderStepped:Connect(function()
        if not char or not char.Parent then return end

        local moveDir = hum.MoveDirection
        if moveDir.Magnitude > 0 then
            local targetCF = CFrame.lookAt(root.Position, root.Position + moveDir * Vector3.new(1, 0, 1))
            root.CFrame = root.CFrame:Lerp(targetCF, rotSpd)

            if math.random() < tpChance then
                local randN = math.random() * (maxN - minN) + minN
                root.CFrame = root.CFrame + root.CFrame.LookVector * randN
            end
        end
    end)
end

local function onCharAdded(char)
    applyFX(char)
end

plr.CharacterAdded:Connect(onCharAdded)
if plr.Character then
    applyFX(plr.Character)
end
